(this["webpackJsonpcorona-cub"]=this["webpackJsonpcorona-cub"]||[]).push([[0],{101:function(e,t,a){},111:function(e,t,a){},112:function(e,t,a){},206:function(e,t,a){},207:function(e,t,a){},208:function(e,t,a){},209:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(17),c=a.n(l),i=(a(101),a(20)),o=a(38),s=a.n(o),u=a(62),m=a(21),d=a(22),h=a(25),v=a(23),f=a(24),p=a(86),g=a(27),b=a(26),E=a(94),y=a(93),x=a(36),j=(a(111),function(e){return e}),O=function(e,t){var a=t.map((function(t){return Math.abs(t-e)}));return t[a.indexOf(Math.min.apply(Math,Object(i.a)(a)))]},C=function(e){return 100*e-5*(e-.5)},k=function(e){function t(e){var a;Object(m.a)(this,t),(a=Object(h.a)(this,Object(v.a)(t).call(this,e))).onMouseDown=function(){a.setState({isDragging:!0})},a.onMouseUp=function(){var e=Object(x.a)(a),t=e.props,n=e.state,r=e.availableValues,l=n.value;l=O(l,r),t.onChange(l),a.setState({value:l,isDragging:!1,isSnapped:!0})},a.onChange=function(e){var t=e.target,n=Object(x.a)(a),r=n.props,l=n.availableValues,c=n.snapRange,i=t.value,o=!1,s=!0,u=!1,m=void 0;try{for(var d,h=l[Symbol.iterator]();!(s=(d=h.next()).done);s=!0){var v=d.value;if(Math.abs(i-v)<c){i=v,o=!0,i=Number(i),r.onChange(i);break}}}catch(f){u=!0,m=f}finally{try{s||null==h.return||h.return()}finally{if(u)throw m}}a.setState({value:i,isSnapped:o})};var n,r,l=e.max,c=void 0===l?0:l,o=e.min,s=void 0===o?100:o,u=e.availableValues,d=void 0===u?[]:u,f=e.formatValue,p=void 0===f?j:f;return a.formatValue=p,a.availableValues=function(e,t,a){return e.filter((function(e){return e<a})).filter((function(e){return e>t}))}((n=d,n.filter((function(e,t,a){return a.indexOf(e)===t}))),s,c).sort(),a.availableValues.unshift(s),a.availableValues.push(c),a.snapRange=Math.min((c-s)/25,(r=a.availableValues,Math.min.apply(Math,Object(i.a)(r.map((function(e,t){return 0===t?r[r.length-1]:Math.abs(e-r[t-1])}))))/2)),a.state={value:0,isDragging:!1,isSnapped:!1},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){2===this.availableValues.length&&console.log("Warning: Select has no available values apart from the edges");var e=this.props,t=e.min,a=e.startValue,n=O(a,this.availableValues)||t;e.onChange(n),this.setState({value:n,isSnapped:!0})}},{key:"render",value:function(){var e=this.props,t=this.state,a=this.availableValues,n=this.formatValue,l=this.onChange,c=this.onMouseDown,i=this.onMouseUp,o=e.min,s=e.max,u=t.value,m=t.isDragging,d=t.isSnapped,h={type:"range",min:o,max:s,value:u||o,onChange:l,onMouseDown:c,onMouseUp:i,onTouchStart:c,onTouchEnd:i},v=Math.abs(s-o),f="".concat(C((u-o)/v),"%"),p=m?"dragging":"",g=d?"snapped":"",b="discrete-slider ".concat(p),E={className:"discrete-slider__thumb",style:{left:f}},y={className:"discrete-slider__thumb-animation ".concat(p),style:{left:f}},x={className:"discrete-slider__display-value ".concat(g),style:{display:u<=o+this.snapRange||u>=s-this.snapRange?"none":"block",left:f}};return r.a.createElement("div",{className:b},r.a.createElement("input",h),r.a.createElement("div",E),r.a.createElement("div",y),r.a.createElement("div",x,n(u)),r.a.createElement("div",{className:"discrete-slider__markers"},a.map((function(e,t){return r.a.createElement("div",{key:t,className:"discrete-slider__markers__marker",style:{left:"".concat(C((e-o)/v),"%")}})}))))}}]),t}(n.Component),w=(a(112),function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(v.a)(t).call(this))).handleToggle=function(){e.setState({isExpanded:!e.state.isExpanded})},e.handleCollapse=function(){e.setState({isExpanded:!1})},e.state={isExpanded:!1},e}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state,t=this.handleToggle,a=e.isExpanded,l="navigation ".concat(a?"expanded":""),c="navigation-toggle ".concat(a?"expanded":"");return r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:c,onClick:t},r.a.createElement(S,null)),r.a.createElement("nav",{className:l},r.a.createElement("div",{className:"navigation__brand"},"Corona",r.a.createElement("span",null,"hub")),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(N,null),r.a.createElement(g.b,{to:"/",activeClassName:"active"},"Home")),r.a.createElement("li",null,r.a.createElement(z,null),r.a.createElement(g.b,{to:"/table",activeClassName:"active"},"Table")),r.a.createElement("li",null,r.a.createElement(M,null),r.a.createElement(g.b,{to:"/survey",activeClassName:"active"},"Survey")),r.a.createElement("li",null,r.a.createElement(T,null),r.a.createElement(g.b,{to:"/contact",activeClassName:"active"},"Contact")),r.a.createElement("li",null,r.a.createElement(_,null),r.a.createElement(g.b,{to:"/imprint",activeClassName:"active"},"Imprint")))))}}]),t}(n.Component)),S=function(){return r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M12 18c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3z"}))},N=function(){return r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M21 13v10h-6v-6h-6v6h-6v-10h-3l12-12 12 12h-3zm-1-5.907v-5.093h-3v2.093l3 3z"}))},z=function(){return r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M20 19h-4v-4h4v4zm-6-10h-4v4h4v-4zm6 0h-4v4h4v-4zm-12 6h-4v4h4v-4zm16-14v22h-24v-22h24zm-2 6h-20v14h20v-14zm-8 8h-4v4h4v-4zm-6-6h-4v4h4v-4z"}))},M=function(){return r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M7 16h10v1h-10v-1zm0-1h10v-1h-10v1zm15-13v22h-20v-22h3c1.229 0 2.18-1.084 3-2h8c.82.916 1.771 2 3 2h3zm-11 1c0 .552.448 1 1 1s1-.448 1-1-.448-1-1-1-1 .448-1 1zm9 1h-4l-2 2h-3.898l-2.102-2h-4v18h16v-18zm-13 9h10v-1h-10v1zm0-2h10v-1h-10v1z"}))},T=function(){return r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M0 3v18h24v-18h-24zm21.518 2l-9.518 7.713-9.518-7.713h19.036zm-19.518 14v-11.817l10 8.104 10-8.104v11.817h-20z"}))},_=function(){return r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M20 12.875v5.068c0 2.754-5.789 4.057-9 4.057-3.052 0-9-1.392-9-4.057v-6.294l9 4.863 9-3.637zm-8.083-10.875l-12.917 5.75 12 6.5 11-4.417v7.167h2v-8.25l-12.083-6.75zm13.083 20h-4c.578-1 1-2.5 1-4h2c0 1.516.391 2.859 1 4z"}))},F=a(47),D=a(32),V={id:"clusters",type:"circle",source:"covid-19",paint:{"circle-color":["step",["get","confirmed"],"#03befc",20,"#f1f075",800,"#f28cb1",5e3,"#ba1818"],"circle-radius":["step",["zoom"],4,2,6,4,["interpolate",["cubic-bezier",0,.5,1,.5],["get","confirmed"],20,8,5e3,25]]}},R={id:"cluster-count",type:"symbol",source:"covid-19",layout:{"text-field":["get","confirmed"],"text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":["step",["zoom"],0,4,11]}},B=(a(114),function(e){var t=e.data,a=e.mapStyle,l=e.onClick,c=Object(n.useState)({width:"100vw",height:"100vh",latitude:45,longitude:10,zoom:4}),i=Object(F.a)(c,2),o=i[0],s=i[1],u="mapbox://styles/mapbox/".concat(a);return r.a.createElement(D.d,Object.assign({},o,{onViewportChange:s,mapboxApiAccessToken:"pk.eyJ1IjoiZ2lhbm5vdHIiLCJhIjoiY2s3aHFkcDkwMGMzYjNlbzNvMWl4bGFxbyJ9.2p2O5m7aiA6Bn9vjPe7HrQ",mapStyle:u,onClick:l}),r.a.createElement(D.c,{id:"covid-19",type:"geojson",data:t},r.a.createElement(D.a,V),r.a.createElement(D.a,R)),r.a.createElement("div",{style:{position:"absolute",bottom:"45px",right:"20px"}},r.a.createElement(D.b,null)))}),A=a(49),I=a(91),J={base:"16px",spacing:"1rem",typography:{font:{sans:"Jura",serif:"Forum"},text:"1rem",title:"2rem"},breakpoint:{xs:"0em",sm:"30em",md:"64em",lg:"75em"},color:{primary:"#6d9197",secondary:"#c4cdc1",tertiary:"99aead",dark:"#28364d",light:"#dee1dd",infected:"#2f575d",recovered:"#658b6f",deaths:"#f8b95f"},border:{radius:"20px",boxShadow:"0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23)"},lenghts:{navigation:{offset:"35px",height:"90vh"}}},P=function(e,t,a){return{label:e,data:Object.values(t),borderColor:a,backgroundColor:"transparent",borderWidth:2}},U=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(v.a)(t).call(this,e))).node=null,a.chart=null,a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.data,t=e.confirmed,a=e.recovered,n=e.deaths;this.chart=new I.a(this.node,{type:"line",data:{labels:Object.keys(t),datasets:[P("Confirmed",t,J.color.infected),P("Recovered",a,J.color.recovered),P("Deaths",n,J.color.deaths)]},options:{elements:{point:{radius:0}},legend:{display:!1},scales:{xAxes:[{display:!1}],yAxes:[{display:!1,ticks:{beginAtZero:!0}}]},layout:{padding:{left:25,right:25,top:40,bottom:40}}}})}},{key:"render",value:function(){var e=this;return r.a.createElement("canvas",{ref:function(t){return e.node=t}})}}]),t}(n.Component),W=function(e,t){return e+t},H=function(e,t){return e||t},L=function(e){return"object"!==typeof e&&(e=[e]),e},Y=function(e,t){return e?t.map((function(t){return t[e]})).reduce(W,0):0},G=function(e,t){var a={};return Object.keys(t).forEach((function(n){a[n]=function(e,t){return"object"===typeof e?e.map((function(e){return Y(e,t)})).reduce(W,0):Y(e,t)}(e,t[n])})),a},Z=function(e,t,a){return a.filter((function(a){return n=t,r=L(e).map((function(e){return a[e]})),!n||r.map((function(e){return n.includes(e)})).reduce(H,!1);var n,r}))},Q=function(e,t){for(var a=e+"";a.length<t;)a="0"+a;return a},$=new Intl.NumberFormat("en-US"),q=function(e){return $.format(e)},K=new Intl.NumberFormat("en-IN",{maximumSignificantDigits:3}),X=function(e){return K.format(e)},ee=(a(206),function(e){var t=e.confirmed,a=e.deaths,l=e.recovered;return r.a.createElement(n.Fragment,null,r.a.createElement(te,{cls:"confirmed",heading:"Confirmed"},q(t)),r.a.createElement(te,{cls:"recovered",heading:"Recovered"},q(l)),r.a.createElement(te,{cls:"deaths",heading:"Deaths"},q(a)),r.a.createElement(te,{cls:"computations",heading:"Computations"},r.a.createElement("div",null,"Active cases: ",q(t-a-l)),r.a.createElement("div",null,"Recover rate: ","".concat(X(l/t*100),"%")),r.a.createElement("div",null,"Mortality rate: ","".concat(X(a/t*100),"%"))))}),te=function(e){var t=e.cls,a=e.heading,n=e.children;return t="data-panel__tile ".concat(t),r.a.createElement("div",{className:t},r.a.createElement("div",{className:"data-panel__tile__heading"},a),r.a.createElement("div",{className:"data-panel__tile__content"},n))},ae=function(e){var t=e.onToggleFilters,a=e.onToggleCharts;return r.a.createElement("div",{className:"data-panel__controls"},r.a.createElement("span",{onClick:t},r.a.createElement(ne,null)),r.a.createElement("span",{onClick:a},r.a.createElement(re,null)))},ne=function(){return r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M1 0l9 15.094v5.906l4 3v-8.906l9-15.094h-22zm18.479 2l-2.981 5h-8.996l-2.981-5h14.958z"}))},re=function(){return r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M24 11.871l-5-4.871v3h-19v4h19v3z"}))},le=function(e){var t,a,l=e.data,c=e.currentTime,i=e.chartsExpanded,o=e.onToggleFilters,s=e.onToggleCharts,u=!!Object.keys(l).length;if(u){var m=G("confirmed",l),d=G("recovered",l),h=G("deaths",l);t={confirmed:Object(A.a)({},m),recovered:Object(A.a)({},d),deaths:Object(A.a)({},h)},a={confirmed:m[c],recovered:d[c],deaths:h[c]}}var v={onToggleFilters:o,onToggleCharts:s},f="charts-container ".concat(i?"expanded":"");return r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"data-panel"},u&&r.a.createElement(ee,a),r.a.createElement(ae,v)),r.a.createElement("div",{className:f},u&&r.a.createElement(U,{data:t})))},ce=(a(207),function(){return r.a.createElement("div",{className:"loader-wrapper"},r.a.createElement("div",{className:"loader-title"},"CORONA hub"),r.a.createElement("div",{className:"loader"},Object(i.a)(Array(25).keys()).map((function(e){return r.a.createElement("div",{key:e})}))))}),ie=function(){return r.a.createElement("div",{className:"survey"},r.a.createElement("h2",null,"Survey"))},oe=(a(208),function(e){switch(e){case"satellite-v9":return"light-v10";case"light-v10":return"dark-v10";case"dark-v10":return"streets-v11";case"streets-v11":return"satellite-v9";default:console.log("Sorry, the style '".concat(e,"' doesn't exist."))}}),se=function(){return Object(p.usePromiseTracker)({delay:3e3}).promiseInProgress&&r.a.createElement(ce,null)},ue=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(v.a)(t).call(this))).handleReload=function(){document.location.reload()},e.handleSwitchTheme=function(){var t=e.state.mapStyle;e.setState({mapStyle:oe(t)})},e.handleSetTime=function(t){var a=e.state.data.filtered,n=Object.keys(a);e.setState({currentTime:Number(t)+Number(n[0])})},e.handleSetLive=function(){var t=e.state.data.filtered,a=Object.keys(t);e.setState({currentTime:a[a.length-1]})},e.handleToggleCharts=function(){e.setState({chartsExpanded:!e.state.chartsExpanded})},e.handleCollapseCharts=function(){e.setState({chartsExpanded:!1})},e.handleToggleFilters=function(){e.setState({filtersExpanded:!e.state.filtersExpanded})},e.handleCollapseFilters=function(){e.setState({filtersExpanded:!1})},e.handleFilterCountries=function(t){e.setState({filteredRegions:t});var a=e.state.data,n=a.fetched;t&&t.length>0?(t=t.map((function(e){return e.value})),a.filtered=function(e,t,a){var n={};return Object.keys(a).forEach((function(r){n[r]=Z(e,t,a[r])})),n}(["province","country"],t,n)):a.filtered=a.fetched,e.setState({data:a})},e.setTime=function(t){e.setState({currentTime:t})},e.getLiveData=Object(u.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://cors-anywhere.herokuapp.com/http://nodejs-express-app-yadii.eu-gb.mybluemix.net/getOfficialData");case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)}))),e.state={mapStyle:"dark-v10",data:{fetched:{},filtered:{}},survey:{},currentTime:0,filteredRegions:[],chartsExpanded:!1,filtersExpanded:!1},e.registeredRegions=[],e}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,a,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLiveData();case 2:t=e.sent,a=Object.keys(t),n=Number(a[a.length-1]),console.log(a),this.setState({data:{fetched:t,filtered:t,currentTime:n}}),r=[].concat(Object(i.a)(t[n].map((function(e){return e.province})).filter((function(e){return!!e}))),Object(i.a)(t[n].map((function(e){return e.country})))),this.registeredRegions=Object(i.a)(new Set(r)).map((function(e){return{value:e,label:e}}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=this.registeredRegions,a=this.handleFilterCountries,l=this.handleSetTime,c=this.handleToggleCharts,i=this.handleCollapseCharts,o=this.handleToggleFilters,s=this.handleCollapseFilters,u=e.mapStyle,m=e.data.filtered,d=e.currentTime,h=e.filteredRegions,v=e.chartsExpanded,f=e.filtersExpanded,p=Object.keys(m),x=function(e){var t={type:"FeatureCollection",features:[]};if(e){var a=[],n=!0,r=!1,l=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var o=c.value,s=o.province,u=o.country,m=o.confirmed,d=o.recovered,h=o.deaths,v=o.latlng,f=Object(F.a)(v,2),p=f[0],g=f[1];a.push({type:"Feature",properties:{province:s,country:u,confirmed:Number(m),recovered:Number(d),deaths:Number(h)},geometry:{type:"Point",coordinates:[Number(g),Number(p)]}})}}catch(b){r=!0,l=b}finally{try{n||null==i.return||i.return()}finally{if(r)throw l}}t.features=a}return t}(m[d]);return r.a.createElement(g.a,null,r.a.createElement("div",{className:"app"},r.a.createElement(se,null),r.a.createElement(w,null),r.a.createElement(b.c,null,r.a.createElement(b.a,{path:"/"},r.a.createElement(E.a,{open:f,onClose:s,classNames:{modal:"modal-filters"},center:!0},r.a.createElement("h2",null,"Data filters"),r.a.createElement("div",{className:"filter-label"},"Country"),r.a.createElement(y.a,{isMulti:!0,name:"countries",options:t,defaultValue:h,onChange:a}),r.a.createElement("div",{className:"filter-label"},"Time"),r.a.createElement(k,{min:0,max:p[p.length-1]-p[0],availableValues:p.map((function(e){return e-p[0]})),startValue:d-p[0],onChange:l,formatValue:function(e){return t=new Date(e+Number(p[0])),"".concat(Q(t.getDate(),2),".").concat(Q(t.getMonth()+1,2),".").concat(t.getFullYear());var t}})),m&&r.a.createElement(le,{data:m,currentTime:d,chartsExpanded:v,onToggleFilters:o,onToggleCharts:c}),x&&r.a.createElement(B,{data:x,mapStyle:u,onClick:i})),r.a.createElement(b.a,{path:"/table"},r.a.createElement(n.Fragment,null)),r.a.createElement(b.a,{path:"/survey"},r.a.createElement(ie,null)),r.a.createElement(b.a,{path:"/contact"},r.a.createElement(n.Fragment,null)),r.a.createElement(b.a,{path:"/imprint"},r.a.createElement(n.Fragment,null)))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},96:function(e,t,a){e.exports=a(209)}},[[96,1,2]]]);
//# sourceMappingURL=main.38270a09.chunk.js.map