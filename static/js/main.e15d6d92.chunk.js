(this["webpackJsonpcorona-map"]=this["webpackJsonpcorona-map"]||[]).push([[0],{30:function(e,t,a){e.exports=a(47)},35:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),c=a(25),l=a.n(c),i=(a(35),a(11)),o=a(26),s=a(6),d=a.n(s),m=a(17),u=a(12),v=a(13),h=a(15),p=a(14),f=a(16),b=a(9),E=a(29),y=a(8),g={id:"clusters",type:"circle",source:"covid-19",paint:{"circle-color":["step",["get","confirmed"],"#03befc",20,"#f1f075",800,"#f28cb1",5e3,"#ba1818"],"circle-radius":["step",["zoom"],4,2,6,4,["interpolate",["cubic-bezier",0,.5,1,.5],["get","confirmed"],20,8,5e3,25]]}},k={id:"cluster-count",type:"symbol",source:"covid-19",layout:{"text-field":["get","confirmed"],"text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":["step",["zoom"],0,4,11]}},w=function(e){var t=e.data,a=e.mapStyle,c=Object(n.useState)({width:"100vw",height:"100vh",latitude:45,longitude:10,zoom:4}),l=Object(E.a)(c,2),i=l[0],o=l[1],s="mapbox://styles/mapbox/".concat(a);return r.a.createElement(y.d,Object.assign({},i,{onViewportChange:o,mapboxApiAccessToken:"pk.eyJ1IjoiZ2lhbm5vdHIiLCJhIjoiY2s3aHFkcDkwMGMzYjNlbzNvMWl4bGFxbyJ9.2p2O5m7aiA6Bn9vjPe7HrQ",mapStyle:s}),r.a.createElement(y.c,{id:"covid-19",type:"geojson",data:t},r.a.createElement(y.a,g),r.a.createElement(y.a,k)),r.a.createElement("div",{style:{position:"absolute",bottom:"40px",left:"20px"}},r.a.createElement(y.b,null)))},x=(a(43),function(e){var t=e.data,a=t.confirmed,n=t.deaths,c=t.recovered;return r.a.createElement("div",{className:"live-data-panel"},r.a.createElement("div",{className:"live-data-panel__sign"},r.a.createElement("div",{className:"blinking-light"}),"Live Data"),r.a.createElement("div",{className:"live-data-panel__tile confirmed"},r.a.createElement("div",{className:"live-data-panel__key"},"Confirmed"),r.a.createElement("div",{className:"live-data-panel__value"},a)),r.a.createElement("div",{className:"live-data-panel__tile deaths"},r.a.createElement("div",{className:"live-data-panel__key"},"Deaths"),r.a.createElement("div",{className:"live-data-panel__value"},n)),r.a.createElement("div",{className:"live-data-panel__tile recovered"},r.a.createElement("div",{className:"live-data-panel__key"},"Recovered"),r.a.createElement("div",{className:"live-data-panel__value"},c)))}),j=(a(44),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).onMouseMove=function(e){var t=e.target,n=e.clientX,r=e.clientY,c=t.dataset.label;a.setState({tooltipLabel:c,clientX:n,clientY:r})},a.state={clientX:0,clientY:0,tooltipLabel:""},a}return Object(f.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props,t=this.state,a=this.onMouseMove,c=e.handleReload,l=e.handleSetLive,i=e.handleSwitchTheme,o=e.handleExpandTimeline,s=t.tooltipLabel,d=t.clientX,m={top:t.clientY+8,left:d+12,padding:s?"6px":"0"};return r.a.createElement(n.Fragment,null,r.a.createElement(S,{sty:m,content:s}),r.a.createElement(N,{onMouseMove:a},r.a.createElement(_,null),r.a.createElement(O,{label:"Reload",onClick:c,icon:r.a.createElement(T,null)}),r.a.createElement(O,{label:"Switch Theme",onClick:i,icon:r.a.createElement(D,null)}),r.a.createElement(O,{label:"Back to Live Data",onClick:l,icon:r.a.createElement(C,null)}),r.a.createElement(O,{label:"Archived Data",onClick:o,icon:r.a.createElement(M,null)})))}}]),t}(n.Component)),N=function(e){var t=e.onMouseMove,a=e.children;return r.a.createElement("div",{className:"controls",onMouseMove:t},a)},S=function(e){var t=e.sty,a=e.content;return r.a.createElement("div",{className:"controls-tooltip",style:t},a)},_=function(){return r.a.createElement("div",{className:"controls__icon"},r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M12 18c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3z"})))},O=function(e){var t=e.label,a=e.onClick,n=e.icon;return r.a.createElement("div",{className:"controls__button","data-label":t,onClick:a},n)},T=function(){return r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M20.944 12.979c-.489 4.509-4.306 8.021-8.944 8.021-2.698 0-5.112-1.194-6.763-3.075l1.245-1.633c1.283 1.645 3.276 2.708 5.518 2.708 3.526 0 6.444-2.624 6.923-6.021h-2.923l4-5.25 4 5.25h-3.056zm-15.864-1.979c.487-3.387 3.4-6 6.92-6 2.237 0 4.228 1.059 5.51 2.698l1.244-1.632c-1.65-1.876-4.061-3.066-6.754-3.066-4.632 0-8.443 3.501-8.941 8h-3.059l4 5.25 4-5.25h-2.92z"}))},D=function(){return r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M21.698 10.658l2.302 1.342-12.002 7-11.998-7 2.301-1.342 9.697 5.658 9.7-5.658zm-9.7 10.657l-9.697-5.658-2.301 1.343 11.998 7 12.002-7-2.302-1.342-9.7 5.657zm12.002-14.315l-12.002-7-11.998 7 11.998 7 12.002-7z"}))},C=function(){return r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M12.015 7c4.751 0 8.063 3.012 9.504 4.636-1.401 1.837-4.713 5.364-9.504 5.364-4.42 0-7.93-3.536-9.478-5.407 1.493-1.647 4.817-4.593 9.478-4.593zm0-2c-7.569 0-12.015 6.551-12.015 6.551s4.835 7.449 12.015 7.449c7.733 0 11.985-7.449 11.985-7.449s-4.291-6.551-11.985-6.551zm-.015 3c-2.21 0-4 1.791-4 4s1.79 4 4 4c2.209 0 4-1.791 4-4s-1.791-4-4-4zm-.004 3.999c-.564.564-1.479.564-2.044 0s-.565-1.48 0-2.044c.564-.564 1.479-.564 2.044 0s.565 1.479 0 2.044z"}))},M=function(){return r.a.createElement("svg",{width:"24",height:"24",fillRule:"evenodd",clipRule:"evenodd"},r.a.createElement("path",{d:"M5.829 6c-.412 1.165-1.524 2-2.829 2-1.656 0-3-1.344-3-3s1.344-3 3-3c1.305 0 2.417.835 2.829 2h13.671c2.484 0 4.5 2.016 4.5 4.5s-2.016 4.5-4.5 4.5h-4.671c-.412 1.165-1.524 2-2.829 2-1.305 0-2.417-.835-2.829-2h-4.671c-1.38 0-2.5 1.12-2.5 2.5s1.12 2.5 2.5 2.5h13.671c.412-1.165 1.524-2 2.829-2 1.656 0 3 1.344 3 3s-1.344 3-3 3c-1.305 0-2.417-.835-2.829-2h-13.671c-2.484 0-4.5-2.016-4.5-4.5s2.016-4.5 4.5-4.5h4.671c.412-1.165 1.524-2 2.829-2 1.305 0 2.417.835 2.829 2h4.671c1.38 0 2.5-1.12 2.5-2.5s-1.12-2.5-2.5-2.5h-13.671zm6.171 5c.552 0 1 .448 1 1s-.448 1-1 1-1-.448-1-1 .448-1 1-1z"}))},z=function(e,t){for(var a=e+"";a.length<t;)a="0"+a;return a};a(45);!function(){if("function"===typeof Object.defineProperty)try{Object.defineProperty(Array.prototype,"sortBy",{value:e})}catch(t){}function e(e){for(var t=this.length;t;){var a=this[--t];this[t]=[].concat(e.call(a,a,t),a)}this.sort((function(e,t){for(var a=0,n=e.length;a<n;++a)if(e[a]!=t[a])return e[a]<t[a]?-1:1;return 0}));for(t=this.length;t;)this[--t]=this[t][this[t].length-1];return this}Array.prototype.sortBy||(Array.prototype.sortBy=e)}();var A=function(e){var t=e.cls,a=e.children;return r.a.createElement("div",{className:t},a)},L=function(e){var t=e.timestamp,a=e.currentTimestamp,n={onClick:e.onClick,"data-timestamp":t,style:t===a?{pointerEvents:"none",opacity:".5"}:{}},c=new Date(t);return r.a.createElement("div",Object.assign({className:"timeline__node"},n),r.a.createElement("div",Object.assign({className:"timeline__node__circle"},n)),r.a.createElement("div",Object.assign({className:"timeline__node__timestamp"},n),function(e){return"".concat(z(e.getDate(),2),".").concat(z(e.getMonth()+1,2),".").concat(e.getFullYear())}(c)))},B=function(e){var t={className:"close-button",onClick:e.onClick};return r.a.createElement("div",t,r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.81 9.186 9.105-9.095 9.184 2.81 2.81 9.112-9.192 9.18 9.1z"})))},P=function(e){var t=e.timestamps,a=e.expanded,n=e.selectedDate,c=e.handleCollapseTimeline,l=e.handleTimeSelect,i="timeline ".concat(a?"expanded":"");return r.a.createElement(A,{cls:i},r.a.createElement(B,{onClick:c}),t.sortBy((function(e){return new Date(e)})).map((function(e){return r.a.createElement(L,{key:e,timestamp:e,currentTimestamp:n,onClick:l})})))},R=a(28),F=(a(46),function(){return r.a.createElement("div",{className:"loader-wrapper"},r.a.createElement("div",{className:"loader-title"},"COVID-19 Map"),r.a.createElement("div",{className:"loader"},Object(R.a)(Array(25).keys()).map((function(e){return r.a.createElement("div",{key:e})}))))}),Y=function(){var e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e},I=function(e){for(var t=[],a=!1,n=0,r=0,c=0;c<e.length;c++){var l=e[c],i=e[c+1];t[n]=t[n]||[],t[n][r]=t[n][r]||"",'"'===l&&a&&'"'===i?(t[n][r]+=l,++c):'"'!==l?","!==l||a?"\r"!==l||"\n"!==i||a?("\n"!==l||a)&&("\r"!==l||a)?t[n][r]+=l:(++n,r=0):(++n,r=0,++c):++r:a=!a}return t},G=function(e){e.setDate(e.getDate()-1)},H="https://cors-anywhere.herokuapp.com/",J=function(){return Object(b.usePromiseTracker)({delay:2500}).promiseInProgress&&r.a.createElement(F,null)},X=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(p.a)(t).call(this))).handleReload=function(){document.location.reload()},e.handleSetLive=function(){e.setState({selectedDate:"current",timelineExpanded:!1})},e.handleSwitchTheme=function(){var t=e.state.mapStyle;switch(t){case"satellite-v9":t="light-v10";break;case"light-v10":t="dark-v10";break;case"dark-v10":t="streets-v11";break;case"streets-v11":t="satellite-v9";break;default:console.log("Sorry, the style "+t+" doesn't exist.")}e.setState({mapStyle:t})},e.handleExpandTimeline=function(){e.setState({timelineExpanded:!0})},e.handleCollapseTimeline=function(){e.setState({timelineExpanded:!1})},e.handleTimeSelect=function(t){var a=t.target.dataset.timestamp;e.setState({selectedDate:a})},e.getLiveData=Object(m.a)(d.a.mark((function t(){var a,n,r,c,l,i,o,s,m,u;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=new Headers({"Content-Type":"application/json",Accept:"application/json"}),"GET","cors","json","default",n=Y()?"./data-fallback/live/covid19-total.json":"".concat(H,"https://covid19.mathdro.id/api"),r=Y()?"./data-fallback/live/covid19-countries.json":"".concat(H,"https://covid19.mathdro.id/api/deaths"),c={headers:a,method:"GET",mode:"cors",type:"json",cache:"default"},l=new Request(n,c),i=new Request(r,c),t.next=7,Object(b.trackPromise)(fetch(l,c));case 7:return o=t.sent,t.next=10,Object(b.trackPromise)(fetch(i,c));case 10:return s=t.sent,t.prev=11,t.next=14,o.json();case 14:return m=t.sent,t.next=17,s.json();case 17:u=t.sent,t.next=23;break;case 20:t.prev=20,t.t0=t.catch(11),console.error(t.t0);case 23:m&&u&&e.setState({dataLive:{total:m,countries:u}});case 24:case"end":return t.stop()}}),t,null,[[11,20]])}))),e.getArchivedData=function(){var t=Object(m.a)(d.a.mark((function t(a){var n,r,c,l,s,m;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Headers,"GET","cors","text/csv","default",r="./data/archived/".concat(a,".csv"),c={headers:n,method:"GET",mode:"cors",type:"text/csv",cache:"default"},l=new Request(r,c),t.next=5,Object(b.trackPromise)(fetch(l,c));case 5:return s=t.sent,m=null,t.prev=7,t.next=10,s.text();case 10:m=t.sent,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(7),console.error(t.t0);case 16:m&&e.setState((function(e){return{dataArchived:Object(o.a)({},e.dataArchived,Object(i.a)({},a,I(String(m))))}}));case 17:case"end":return t.stop()}}),t,null,[[7,13]])})));return function(e){return t.apply(this,arguments)}}(),e.state={selectedDate:"current",dataArchived:{},dataLive:{total:{confirmed:{value:0},deaths:{value:0},recovered:{value:0}},countries:[]},mapStyle:"dark-v10",timelineExpanded:!1},e}return Object(f.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{for(t=new Date("03-01-2020"),a=new Date,G(a);a.getTime()>=t.getTime();)this.getArchivedData("".concat(z((n=a).getMonth()+1,2),"-").concat(z(n.getDate(),2),"-").concat(n.getFullYear())),G(a);this.getLiveData()}catch(r){console.error(r)}case 1:case"end":return e.stop()}var n}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this.handleReload,a=this.handleSetLive,n=this.handleSwitchTheme,c=this.handleExpandTimeline,l=this.handleCollapseTimeline,i=this.handleTimeSelect,o=this.state,s=o.selectedDate,d=o.dataLive,m=o.dataArchived,u=o.mapStyle,v=o.timelineExpanded;e="current"===s?function(e){var t={type:"FeatureCollection",features:[]};if(e){var a=[],n=!0,r=!1,c=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var o=l.value,s=o.provinceState,d=o.countryRegion,m=o.lastUpdate,u=o.confirmed,v=o.deaths,h=o.recovered,p=o.lat,f=o.long;a.push({type:"Feature",properties:{state:s,region:d,timestamp:Number(m),confirmed:Number(u),deaths:Number(v),recovered:Number(h)},geometry:{type:"Point",coordinates:[Number(f),Number(p)]}}),t.features=a}}catch(b){r=!0,c=b}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return t}}(d.countries):function(e){var t={type:"FeatureCollection",features:[]};if(e){var a=[],n=!0,r=!1,c=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var o=l.value;if("Province/State"!==o[0]){var s=new Date(o[2]);a.push({type:"Feature",properties:{state:o[0],region:o[1],timestamp:Number(s.getTime()),confirmed:Number(o[3]),deaths:Number(o[4]),recovered:Number(o[5])},geometry:{type:"Point",coordinates:[Number(o[7]),Number(o[6])]}})}t.features=a}}catch(d){r=!0,c=d}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return t}}(m[s]);var h=d.total,p=h.confirmed,f=h.deaths,b=h.recovered,E={confirmed:p.value,deaths:f.value,recovered:b.value},y={handleReload:t,handleSwitchTheme:n,handleSetLive:a,handleExpandTimeline:c},g={timestamps:Object.keys(m),expanded:v,selectedDate:s,handleCollapseTimeline:l,handleTimeSelect:i};return r.a.createElement("div",{className:"app"},r.a.createElement(J,null),r.a.createElement(j,y),r.a.createElement(P,g),E&&r.a.createElement(x,{data:E}),e&&r.a.createElement(w,{data:e,mapStyle:u}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.e15d6d92.chunk.js.map